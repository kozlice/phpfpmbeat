version: 1.0

defaults:
  type: string
  required: false
  index: not_analyzed
  doc_values: true
  ignore_above: 1024

env:
  type: group
  description: >
    Contains common fields available in all event types.
  fields:
    - name: "@timestamp"
      type: date
      required: true
      format: YYYY-MM-DDTHH:MM:SS.milliZ
      example: 2015-01-24T14:06:05.071Z
      description: >
        The timestamp when the measurements were taken. The precision is in milliseconds.
        The timezone is UTC.

    - name: type
      description: >
        Set to "phpfpm" to specify that this is PHP-FPM status.
      required: true

    - name: count
      type: int
      description: >
        For how many transactions is this event representative. This
        is generally the inverse of the sampling rate. For example, for
        a sample rate of 1/10, the count is 10. The count is used by the
        UIs to return estimated values. Reserved for future usage.
      required: true

    - name: beat.name
      description: >
        Name of the Beat sending the events. If the shipper name is set
        in the configuration file, then that value is used. If it is not set,
        the hostname is used.

    - name: beat.hostname
      description: >
        The hostname as returned by the operating system on which the Beat is
        running.

phpfpm:
  type: group
  description: >
    Contains PHP-FPM status, data is collected from PHP-FPM status page.
  fields:
    - name: pool
      type: string
      description: >
        The name of the PHP-FPM pool.

    - name: process_manager
      type: string
      description: >
        The process manager mode: "static", "dynamic" or "ondemand".

    - name: start_since
      type: int
      description: >
        The number of seconds since FPM has started or reloaded. Reloading PHP-FPM will reset this value.

    - name: accepted_conn
      type: int
      description: >
        The number of requests accepted by the pool.

    - name: listen_queue
      type: int
      description: >
        The number of requests in the queue of pending connections.

    - name: max_listen_queue
      type: int
      description: >
        The maximum number of requests in the queue of pending connections since FPM has started.

    - name: listen_queue_len
      type: int
      description: >
        The size of the socket queue of pending connections.

    - name: idle_processes
      type: int
      description: >
        The number of idle processes.

    - name: active_processes
      type: int
      description: >
        The number of active processes.

    - name: total_processes
      type: int
      description: >
        The number of idle + active processes.

    - name: max_active_processes
      type: int
      description: >
        The maximum number of active processes since FPM has started.

    - name: max_children_reached
      type: int
      description: >
        The number of times the process limit has been reached (when FPM tries to start more children).
        Only works with "dynamic" and "ondemand" pool types.

    - name: slow_requests
      type: int
      description: >
        The number of requests that exceeded your request_slowlog_timeout value.
